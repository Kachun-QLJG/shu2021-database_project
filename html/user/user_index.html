<!DOCTYPE html>
<html lang="en" ng-app="AngularStore">
<head>
	<script src="/statics/js/header.js"></script>
	<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
	<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<style>
		/*web background*/
		.container{
			display:table;
			height:100%;
		}

		/* centered columns styles */
		.row-centered {
			text-align:center;
		}
		.col-centered {
			display:inline-block;
			float:none;
			text-align:left;
			margin-right:-4px;
		}
		.middle {

			float: none;

			display: inline-block;

			vertical-align: middle;

		}
		.vcenter-item{
			display: flex;
			align-items: center;
		}
		/*
		.row > div {
			display: inline-block;
			vertical-align: middle;
			float: none;
		}*/
	</style>
</head>
<body bgcolor="#f0f8ff" id="body" onkeydown="keychangeprofile()">
	<!--
	<div style="margin-top: 5%;">
			<div style="margin-left: 10%; margin-right: 10%; text-align: center;">
				<embed height="1080px" src="/show_pdf?attorney_no=00000001" width="90%"/>
			</div> /.mb-4 -->
	<!--</div> /.row -->
	<!--
<body bgcolor="#f0f8ff" id="body" onkeydown="keychangeprofile()">

<div style="margin-top: 5%;">
		<div style="margin-left: 10%; margin-right: 10%; text-align: center;">
			<embed height="1080px" src="/show_pdf?attorney_no=00000001" width="90%"/>
		</div> <! -- /.mb-4 -->
</div> <!-- /.row -->
	<!--
	<script src="/statics/js/universal.js"></script>
	<script src="/statics/js/user.js"></script>
	-->
	<div class='navbar-header' id='head1'>
		<a class='navbar-brand'>502汽修厂管理系统</a>
	</div>

	<!--右上区块-->
	<div class='collapse navbar-collapse' id='bs-example-navbar-collapse-1'>
		<ul id='navbar' class='nav navbar-nav navbar-right' >
			<li><a id='text' href='/change_userinfo'></a></li>
			<li><a id='register' href='/register' title='注册' >前往注册</a></li>
			<li><a id='login'href='/login' title='登录' >前往登录</a></li>
			<li><a id='logout' title='退出登录' data-toggle='modal' data-target='#log_out' onclick='getUsername()'>退出登录</a></li>
			<li><a href='/change_password'id='changePassword' title='更改密码'>更改密码</a></li>
		</ul>
	</div>

	<!--登出模态框（Modal）-->
	<div class='modal fade' id='log_out' tabindex='-1' role='dialog' aria-labelledby='myModalLabel' aria-hidden='true'>
		<div class='modal-dialog'>
			<div class='modal-content'>
				<div class='modal-header'>
					<button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button>
					<h3 class='modal-title' id='myModalLabel'>您确定要登出当前账号吗？</h3>
					<h4 class='modal-body' id='text1'></h4>
				</div>
				<form class='modal-footer'>
					<button type='submit' value='退出登录' class='btn btn-primary' onclick='logout()'>退出登录</button>
					<button type='button' class='btn btn-default' data-dismiss='modal'>取消</button>
				</form>
			</div>
		</div>
	</div>

	<div class='container-fluid'>
		<div class='row'>
			<!--左导航栏-->
			<div class='col-md-2'>
				<div class='list-group'>
					<a class='list-group-item list-group-item-success'>
						功能
					</a>
					<a class='list-group-item' href='/change_password'>更改密码</a>
                    <a class='list-group-item' href='/change_userinfo'>个人信息</a>
					<a class='list-group-item' href='/u_check_orders' style='cursor:pointer'>查看申请详情</a>
				</div>
			</div>

			<!--右区域-->
			<div class="col-md-10">
				<div class='col-md-10' id='con' >
					<div class='col-md-4 col-md-offset-5'>
						<label style='color: #77bbe2;font-size:50px;text-align: center'>车辆信息</label>
					</div>
					<!--
					<div class='col-md-3'>
						<a type='button' data-toggle='modal' data-target='#add_car' data-backdrop='static' style='font-size: 40px;background-color: #0099CC;color: white;display:inline-block;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;'>新增车辆</a>
					</div>
					-->
				</div>

				<!--第一辆车-->
				<div class='col-md-5' style='background-color: #dff0d8;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 20px;padding: 10px;margin: 1% 3% 1% 2%;'>

					<div class="row vcenter-item" style="box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;margin: 10px;background-color: white">
						<div class='col-md-5 col-md-push-0 vcenter-item' style="vertical-align: middle">
							<img id='licensephoto1' src='show_plate?license_number=' style="width: 130%" class="middle">
						</div>

						<div class='col-md-5 col-md-push-1' style="margin: 7px 7px">
							<div class='row-md-4 text-center' style=" background-color: #bce8f1;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 5px;margin-top: 2%">
								<a type="button" style='font-size: 17px;color: black;cursor: pointer' data-toggle='modal' data-target='#add_car' data-backdrop='static' >历史维修记录</a>
							</div>
							<br>
							<div class='row-md-4 text-center' style=" background-color: #bce8f1;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 5px;margin-top: 2%">
								<a type="button" style='font-size: 17px;color: black;cursor: pointer' data-toggle='modal' data-target='#add_car' data-backdrop='static' >新增维修委托</a>
							</div>
						</div>

					</div>


					<div class="row align-items-end" style="box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px;border-radius: 10px;background-color: white;margin: 7px 7px">
						<h4 id='description1' style='font-size: 15px;display:inline-block;margin-left: 5%'>很土的黄·很贵的车·很敞的篷</h4>
						<br>
						<h4 id='number1' style='font-size: 15px;display:inline-block;margin-left: 5%'>车架号：11111111111111111</h4>
					</div>

				</div>

				<!--第二辆车-->
				<div class='col-md-5' style='background-color: #dff0d8;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 20px;padding: 10px;margin: 1% 3% 1% 2%;'>

					<div class="row vcenter-item" style="box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;margin: 10px;background-color: white">
						<div class='col-md-5 col-md-push-0 vcenter-item' style="vertical-align: middle">
							<img id='licensephoto2' src='show_plate?license_number=' style="width: 130%" class="middle">
						</div>

						<div class='col-md-5 col-md-push-1' style="margin: 7px 7px">
							<div class='row-md-4 text-center' style=" background-color: #bce8f1;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 5px;margin-top: 2%">
								<a type="button" style='font-size: 17px;color: black;cursor: pointer' data-toggle='modal' data-target='#add_car' data-backdrop='static' >历史维修记录</a>
							</div>
							<br>
							<div class='row-md-4 text-center' style=" background-color: #bce8f1;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 5px;margin-top: 2%">
								<a type="button" style='font-size: 17px;color: black;cursor: pointer' data-toggle='modal' data-target='#add_car' data-backdrop='static' >新增维修委托</a>
							</div>
						</div>

					</div>


					<div class="row align-items-end" style="box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px;border-radius: 10px;background-color: white;margin: 7px 7px">
						<h4 id='description2' style='font-size: 15px;display:inline-block;margin-left: 5%'>很土的黄·很贵的车·很敞的篷</h4>
						<br>
						<h4 id='number2' style='font-size: 15px;display:inline-block;margin-left: 5%'>车架号：11111111111111111</h4>
					</div>

				</div>

				<!--第三辆车-->
				<div class='col-md-5' style='background-color: #dff0d8;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 20px;padding: 10px;margin: 1% 3% 1% 2%;'>

					<div class="row vcenter-item" style="box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;margin: 10px;background-color: white">
						<div class='col-md-5 col-md-push-0 vcenter-item' style="vertical-align: middle">
							<img id='licensephoto3' src='show_plate?license_number=' style="width: 130%" class="middle">
						</div>

						<div class='col-md-5 col-md-push-1' style="margin: 7px 7px">
							<div class='row-md-4 text-center' style=" background-color: #bce8f1;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 5px;margin-top: 2%">
								<a type="button" style='font-size: 17px;color: black;cursor: pointer' data-toggle='modal' data-target='#add_car' data-backdrop='static' >历史维修记录</a>
							</div>
							<br>
							<div class='row-md-4 text-center' style=" background-color: #bce8f1;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 5px;margin-top: 2%">
								<a type="button" style='font-size: 17px;color: black;cursor: pointer' data-toggle='modal' data-target='#add_car' data-backdrop='static' >新增维修委托</a>
							</div>
						</div>

					</div>


					<div class="row align-items-end" style="box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px;border-radius: 10px;background-color: white;margin: 7px 7px">
						<h4 id='description3' style='font-size: 15px;display:inline-block;margin-left: 5%'>很土的黄·很贵的车·很敞的篷</h4>
						<br>
						<h4 id='number3' style='font-size: 15px;display:inline-block;margin-left: 5%'>车架号：11111111111111111</h4>
					</div>

				</div>

				<!--第四辆车-->
				<div class='col-md-5' style='background-color: #dff0d8;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 20px;padding: 10px;margin: 1% 3% 1% 2%;'>

					<div class="row vcenter-item" style="box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;margin: 10px;background-color: white">
						<div class='col-md-5 col-md-push-0 vcenter-item' style="vertical-align: middle">
							<img id='licensephoto4' src='show_plate?license_number=' style="width: 130%" class="middle">
						</div>

						<div class='col-md-5 col-md-push-1' style="margin: 7px 7px">
							<div class='row-md-4 text-center' style=" background-color: #bce8f1;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 5px;margin-top: 2%">
								<a type="button" style='font-size: 17px;color: black;cursor: pointer' data-toggle='modal' data-target='#add_car' data-backdrop='static' >历史维修记录</a>
							</div>
							<br>
							<div class='row-md-4 text-center' style=" background-color: #bce8f1;box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px #444;border-radius: 5px;margin-top: 2%">
								<a type="button" style='font-size: 17px;color: black;cursor: pointer' data-toggle='modal' data-target='#add_car' data-backdrop='static' >新增维修委托</a>
							</div>
						</div>

					</div>


					<div class="row align-items-end" style="box-shadow: inset 1px -1px 1px #444, inset -1px 1px 1px;border-radius: 10px;background-color: white;margin: 7px 7px">
						<h4 id='description4' style='font-size: 15px;display:inline-block;margin-left: 5%'>很土的黄·很贵的车·很敞的篷</h4>
						<br>
						<h4 id='number4' style='font-size: 15px;display:inline-block;margin-left: 5%'>车架号：11111111111111111</h4>
					</div>

				</div>

			</div>
		</div>
	</div>

			<!-- 更改个人信息 -->
			<div class='modal fade' id='change_info' tabindex='-1' role='dialog' aria-labelledby='myModalLabel' aria-hidden='true'>
				<div class='modal-dialog'>
					<div class='modal-content'>
						<div class='modal-header'>
							<button type='button' class='close' data-dismiss='modal' aria-hidden='true' >&times;</button>
							<h3 class='modal-title' id='changeUserInfo'>更改个人信息</h3>
						</div>
						<div class='modal-body'>
							<img src='/statics/user/真实姓名.png' width='20px'>
							<label style='font-size:15px;width: 100px;'>姓名：</label>
							<input id='name' type='text' placeholder='请输入姓名'/><br></br>

							<img src='/statics/user/公司.png' width='20px'>
							<label style='font-size:15px;width: 100px;'>性质：</label>
							<select id='property'>
								<option value='个人' selected>个人</option>
								<option value='公司'>公司</option>
							</select><br></br>

							<img src='/statics/user/联系人.png' width='20px'>
							<label style='font-size:15px;width: 100px;'>联系人：</label>
							<input id='contact_person' type='text' placeholder='请输入联系人'/><br></br>

							<img src='/statics/user/联系人.png' width='20px'>
							<label style='font-size:15px;width: 100px;'>联系电话：</label>
							<input id='contact_tel' type='text' readonly='readonly' value='13472413472'/><br></br>

							<img src='/statics/user/联系人.png' width='20px'>
							<label style='font-size:15px;width: 100px;'>折扣率：</label>
							<input id='discount_rate' type='text' readonly='readonly' value='100%'/><br></br>

						</div>
						<form class='modal-footer'>
							<label style='font-size:1px;width: 80px;color: red;'>没有再次确认哦，真的</label>
							<button type='button' class='btn btn-primary' onclick='changeinfo()' id='confirmChangeInfo'>确认更改</button>
							<button type='button' class='btn btn-default' data-dismiss='modal'>取消</button>
						</form>
					</div>
				</div>
			</div>

			<!-- 新增车辆 -->
			<div class='modal fade' id='add_car' tabindex='-1' role='dialog' aria-labelledby='myModalLabel' aria-hidden='true' onkeydown="keycarregister()">
				<div class='modal-dialog'>
					<div class='modal-content'>
						<div class='modal-header'>
							<button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button>
							<h3 class='modal-title' id='addNewVehicle'>新增车辆</h3>
						</div>
						<div class='modal-body'>
							<img src='/statics/user/井号.png' width='20px'>
							<label style='font-size:15px;width: 80px;'>车架号：</label>
							<input id='number' type='text' onchange='check_number()' placeholder='请输入车架号'/>
							<span id='checktext1'></span> <br></br>

							<img src='/statics/user/车牌.png' width='20px'>
							<label style='font-size:15px;width: 80px;'>车牌号：</label>
							<input id='license_number' type='text' onchange='check_license_number()' placeholder='请输入车牌号'/>
							<img src='/statics/user/问号.png' width='20px'>
							<span id='checktext2'></span> <br></br>

							<img src='/statics/user/颜色.png' width='20px'>
							<label style='font-size:15px;width: 80px;'>车辆颜色：</label>
							<input id='color' type='text' placeholder='请输入车辆颜色'/><br></br>

							<img src='/statics/user/车型.png' width='20px'>
							<label style='font-size:15px;width: 80px;'>车型：</label>
							<input id='model' type='text' placeholder='请输入车型'/><br></br>

							<img src='/statics/user/类别.png' width='20px' >
							<label style='font-size:15px;width: 80px;'>车辆类别：</label>
							<select id='type'>
								<option value='轿车-A' selected>轿车-A</option>
								<option value='轿车-B' >轿车-B</option>
								<option value='轿车-C' >轿车-C</option>
								<option value='轿车-D' >轿车-D</option>
								<option value='轿车-E' >轿车-E</option>
							</select>
							<img src='/statics/user/问号.png' width='20px' class="popover-toggle" data-toggle="popover"/>

						</div>
						<form class='modal-footer'>
							<label style='font-size:1px;width: 80px;color: red;'>没有再次确认哦，真的</label>
							<button type='button' class='btn btn-primary' onclick='checkVehicle()' id='confirmAddVehicle'>确认新增</button>
							<button type='button' class='btn btn-default' data-dismiss='modal'>取消</button>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- 添加车辆按钮 -->
	<div class='col-md-3'>
		<img src="/statics/user/添加.png" data-toggle='modal' data-target='#add_car' data-backdrop='static' style='position:fixed;top:70%;right:1%;cursor: pointer'/>
	</div>

	<script>
		window.onload= function(){
			getUserName();
			checkNotification();
			checkGroup();
			checkUser();
			getinfo();
			getVehicle();
		}
		function check_number(){
			var check = false;
			var number = document.getElementById("number").value;
			if(number.length != 17){
				document.getElementById("checktext1").innerHTML = " × 请输入正确的车架号";
				check = false;
			}
			else {
				document.getElementById("checktext1").innerHTML = " √";
				check = true;
			}
			return check;
		}
		function check_license_number(){
			var check = false;
			var license_number = document.getElementById("license_number").value;
			if(license_number.length < 7 || license_number.length > 8){
				document.getElementById("checktext2").innerHTML = " × 请输入正确的车牌号";
				check = false;
			}
			else {
				document.getElementById("checktext2").innerHTML = " √";
				check = true;
			}
			return check;
		}
		function userinfo(){
			axios({
				method : 'get',
				url: "/userinfo"
			})
					.then(function(response){
						var last = response.data;
						document.getElementById("name").value = last.name;
						document.getElementById("property").value = last.property;
						document.getElementById("contact_person").value = last.contact_person;
					})
		}
		function keychangeprofile(){
				if(event.keyCode == 13){
					document.getElementById('confirmChangeInfo').click();
				}
		}
		function keycarregister(){
			if(event.keyCode == 13){
				document.getElementById('confirmAddVehicle').click();
			}
		}
		function getVehicle(){
			axios.get('/get_vehicle',{
				params:{
					pg: 1
				}
			})
					.then(function(response){
						var last = new Array(4);
						var str1,str2,str3;
						for(var i = 0; i < 4;i++){
							last[i]=response.data[i];
							if(last[i].Number !== ""){
								str1 = "licensephoto" + (i+1);
								str2 = "number" + (i+1);
								str3 = "description" + (i+1);
								document.getElementById(str1).src='show_plate?license_number='+ last[i].LicenseNumber;
								document.getElementById(str2).innerHTML='VIN：'+ last[i].Number;
								document.getElementById(str3).innerHTML=last[i].Color + "·" + last[i].Model+ "·" + last[i].Type;
							}
							else{
								break;
							}
						}
					})
		}
		$(function() {
			$("[data-toggle='popover']").each(function() {
				var element = $(this);
				element.popover({
					trigger: 'manual',
					html: true,
					title: '轿车类别',
					placement: 'right',
					content: function() {
						return content();
					}
				}).on("mouseenter", function() {
					var _this = this;
					$(this).popover("show");
					$(this).siblings(".popover").on("mouseleave", function() {
						$(_this).popover('hide');
					});
				}).on("mouseleave", function() {
					var _this = this;
					setTimeout(function() {
						if(!$(".popover:hover").length) {
							$(_this).popover("hide")
						}
					}, 100);
				});

			});

		});
		function  content()  {
			var  data  =  $("<h4>轿车A：排量 < 1.6升</h4>"+ "<h4>轿车B：1.6升 ≤ 排量 ≤ 1.8升</h4>"+ "<h4>轿车C：1.8升 < 排量 ≤ 2.3升</h4>"+ "<h4>轿车D：2.3升 < 排量 ≤ 3升</h4>"+ "<h4>轿车E：3升 ≤ 排量 ≤ 4升</h4>");
			return  data;
		}
	</script>
</body>
</html>

